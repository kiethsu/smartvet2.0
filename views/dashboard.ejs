<style>
  body {
    background-color: #f8f9fa;
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  }
  .top-header { margin: 1.5rem 0; }

  /* User/Retention Small Cards */
  .user-retention-row {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.2rem;
    flex-wrap: wrap;
    align-items: stretch;
    justify-content: flex-start;
  }
  .stats-metric-card {
    background: #fff;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgba(30,34,90,0.07);
    border: 1px solid #e9ecef;
    min-width: 165px;
    max-width: 175px;
    padding: 14px 15px 11px 17px;
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    justify-content: center;
    margin-right: 0.7rem;
    margin-bottom: 0;
  }
  .stats-metric-card:last-child { margin-right: 0; }
  .stats-label {
    font-size: 0.93rem;
    color: #8c98a4;
    font-weight: 500;
    margin-bottom: 0.15rem;
  }
  .stats-main-value {
    font-size: 1.20rem;
    font-weight: 700;
    color: #1c2c45;
    margin-bottom: 2px;
  }
  .stats-change {
    font-size: 0.97rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    margin-top: 1px;
  }
  .stats-change.up {
    color: #28a745;
  }
  .stats-change.down {
    color: #e74c3c;
  }
  .stats-change.neutral {
    color: #adb5bd;
  }
  .stats-change .arrow {
    font-size: 1.1em;
    margin-left: 3px;
  }

  @media (max-width: 991.98px) {
    .user-retention-row { flex-direction: column; gap: 0.7rem; }
    .stats-metric-card { max-width: 100%; width: 100%; margin-right: 0; }
  }

  /* Navigation Pills */
  .sticky-nav {
    position: sticky; top: 0; z-index: 1000;
    background: #f8f9fa;
    padding: .5rem 0;
    border-bottom: 1px solid #e0e0e0;
    margin-bottom: 1rem;
  }
  .sticky-nav .nav-pills {
    justify-content: flex-start;
    gap: .5rem;
  }
  .sticky-nav .nav-link {
    border-radius: 20px;
    padding: .5rem 1rem;
    font-weight: 500;
    color: #555;
  }
  .sticky-nav .nav-link.active {
    background: #007bff;
    color: #fff;
  }
  /* Filters row */
  .filters {
    padding-left: 1.25rem;
  }
  .filters .form-control-sm {
    width: auto;
    min-width: 5ch;
  }

  /* --- Modern Card Styling --- */
  .card-header {
    border-bottom: 1px solid #f1f1f1 !important;
    background: #fff !important;
    display: flex;
    align-items: center;
    font-weight: 600;
    font-size: 1.07rem;
    min-height: 48px;
    padding: .75rem 1.25rem;
    letter-spacing: .01em;
  }
  .card {
    background: #fff;
    border-radius: 14px;
    box-shadow: 0 3px 12px rgba(30,34,90,0.08);
    border: 1px solid #e9ecef;
    transition: box-shadow 0.15s;
    margin-bottom: 1.5rem;
  }
  .card:hover { box-shadow: 0 5px 16px rgba(30,34,90,0.13);}
  .card-body {
    background: #fff;
    padding: 1.15rem;
  }
  .list-group-item {
    border: none;
    padding: .45rem 1rem;
    font-size: 1.02rem;
  }
  .chart, .heatmap {
    min-height: 200px;
    max-height: 270px;
    margin-bottom: 1rem;
  }
  @media (max-width: 991.98px) {
    .card { margin-bottom: 1rem; }
    .chart { min-height: 180px; }
  }

.kpi-card {
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.11);
  padding: 1.1rem 0.5rem 1rem 0.5rem;
  min-width: 130px;
  flex: 1 1 140px;
  text-align: center;
  margin-bottom: 0;
  margin-right: 0.5rem;
  transition: box-shadow .18s;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.kpi-card:last-child { margin-right: 0; }
.kpi-card i { font-size: 1.5rem; color: #007bff; margin-bottom: .3rem; }
.kpi-card h4 { margin: .15rem 0; font-weight: 600; font-size: 1.13rem; }
.kpi-card small { display: block; color: #777; margin-bottom: .25rem; text-transform: uppercase; font-size: .75rem; }


  /* Top 10 SKUs Table */
  #topSkuTable {
    font-size: 0.98rem;
    width: 100%;
    margin-bottom: 0;
  }
  #topSkuTable th,
  #topSkuTable td {
    vertical-align: middle;
    border: none;
    padding: 0.4rem 0.5rem 0.4rem 0.2rem;
  }
  #topSkuTable thead th {
    font-weight: 600;
    color: #333;
    background: transparent;
    border-bottom: 1px solid #e9ecef;
  }
  #topSkuTable tbody tr:not(:last-child) td {
    border-bottom: 1px solid #f3f4f6;
  }
  .sku-name {
    max-width: 110px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }
  .sku-units { color: #888; }
  .sku-revenue { font-weight: bold; color: #007bff; text-align: right; }

  /* Make Top 10 SKUs card fit contents, no scroll! */
  .top-sku-card .card-body {
    padding: 0.8rem 0.5rem 0.8rem 0.5rem;
    max-height: none !important;
    overflow-y: visible !important;
  }

  .svc-dot {
    display: inline-block;
    width: 13px;
    height: 13px;
    border-radius: 50%;
    margin-right: 7px;
    vertical-align: middle;
  }
#appointmentsTrendChartWrapper {
  height: 200px;
  margin-bottom: 1rem;
}

</style>

  </style>
</head>
<body>
  <div class="container-fluid">
    <!-- Top Header -->
    <div class="top-header">
      <h2 class="mb-0">Dashboard</h2>
      <!-- User stats + Retention row -->
    <div class="user-retention-row">
  <!-- Doctors -->
  <div class="stats-metric-card">
    <div class="stats-label">Doctors</div>
    <div class="stats-main-value" id="doctorsCountSmall">1</div>
    <div class="stats-change up">
      <span>+0%</span>
      <span class="arrow">&#8599;</span> <!-- Unicode ↗ -->
    </div>
  </div>
  <!-- HR -->
  <div class="stats-metric-card">
    <div class="stats-label">HR</div>
    <div class="stats-main-value" id="hrCountSmall">2</div>
    <div class="stats-change down">
      <span>-0%</span>
      <span class="arrow">&#8600;</span> <!-- Unicode ↘ -->
    </div>
  </div>
  <!-- Customers -->
  <div class="stats-metric-card">
    <div class="stats-label">Customers</div>
    <div class="stats-main-value" id="customersCountSmall">3</div>
    <div class="stats-change up">
      <span>+0%</span>
      <span class="arrow">&#8599;</span>
    </div>
  </div>
  <!-- Retention/New -->
  <div class="stats-metric-card">
    <div class="stats-label">New vs Retention</div>
    <div class="stats-main-value" id="kpiNewPct">0%</div>
    <div class="stats-change neutral">
      <span id="kpiRetPct">0% Ret</span>
      <span class="arrow">&#8594;</span> <!-- Unicode → -->
    </div>
  </div>
</div>


    <!-- Navigation Pills (restored function) -->
    <nav class="sticky-nav">
      <ul class="nav nav-pills">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="pill" href="#salesOverview">Sales Overview</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="pill" href="#inventoryOverview">Inventory Overview</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="pill" href="#appointmentTrends">Appointment Trends</a>
        </li>
      </ul>
    </nav>
    <!-- Filters -->
   <div class="filters d-flex align-items-center mb-3" id="filterRow">
  <select id="presetRange" class="form-control form-control-sm mr-2">
    <option value="7d">Last 7 Days</option>
    <option value="30d">Last 30 Days</option>
    <option value="mtd">Month-to-Date</option>
    <option value="ytd">Year-to-Date</option>
  </select>
  <input type="text" id="customRange" class="form-control form-control-sm mr-2" placeholder="Custom range"/>
  <select id="compareMode" class="form-control form-control-sm">
    <option value="prev">Compare Previous</option>
    <option value="yoy">Year-over-Year</option>
  </select>
</div>


    <!-- Tab Content -->
    <div class="tab-content">
      <!-- 1) Sales Overview (pane) -->
      <div class="tab-pane fade show active" id="salesOverview">
        <div class="card">
          <div class="card-body">
            <!-- KPI Row -->
            <div class="d-flex flex-wrap mb-4">
              <div class="kpi-card mr-3 mb-3">
                <i class="fas fa-coins"></i>
                <h4 id="kpiRevenue">₱6,845</h4>
                <small>Total Revenue</small>
                <div id="kpiRevChange" class="change">+0.0%</div>
              </div>
              <div class="kpi-card mr-3 mb-3">
                <i class="fas fa-receipt"></i>
                <h4 id="kpiTxns">2</h4>
                <small>Total Txns</small>
                <div id="kpiTxnChange" class="change">+0.0%</div>
              </div>
              <div class="kpi-card mr-3 mb-3">
                <i class="fas fa-shopping-cart"></i>
                <h4 id="kpiAov">₱3,423</h4>
                <small>Avg Order</small>
              </div>
              <div class="kpi-card mb-3">
                <i class="fas fa-percentage"></i>
                <h4 id="kpiConv">100.0%</h4>
                <small>Conv Rate</small>
              </div>
            </div>

            <!-- Grid Row: Chart + Revenue + Top 10 SKU -->
            <div class="row">
              <!-- Sales Trend Chart -->
              <div class="col-lg-4 col-md-12 mb-4">
                <div class="card h-100 shadow-sm">
                  <div class="card-header py-2 px-3">
                    <h6 class="mb-0">Sales Trend</h6>
                  </div>
                  <div class="card-body p-2">
                    <div id="salesTrendChart" class="chart"></div>
                  </div>
                </div>
              </div>
              <!-- Revenue by Service (Donut + Table) -->
              <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 shadow-sm">
                  <div class="card-header py-2 px-3 d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">Revenue by Service</h6>
                    <select id="serviceRevenueRange" class="form-control form-control-sm" style="width:auto;">
                      <option value="today">Today</option>
                      <option value="7d" selected>Last 7 Days</option>
                      <option value="month">Month</option>
                      <option value="year">Year</option>
                    </select>
                  </div>
                  <div class="card-body p-2">
                    <div class="d-flex flex-column align-items-center">
                      <div style="width: 160px; min-width: 100px; margin-bottom: 12px;">
                        <div id="serviceRevenueChart"></div>
                      </div>
                      <div class="w-100">
                        <table class="table table-sm table-borderless mb-0" id="serviceRevenueTable" style="font-size: 0.95rem;">
                          <thead>
                            <tr>
                              <th style="width:28px;"></th>
                              <th>Service</th>
                              <th class="text-right">Revenue</th>
                            </tr>
                          </thead>
                          <tbody></tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Top 10 SKUs (Fixed!) -->
              <div class="col-lg-4 col-md-6 mb-4">
                <div class="card h-100 shadow-sm top-sku-card">
                  <div class="card-header py-2 px-3 d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">Top 10 SKUs</h6>
                    <span class="badge badge-primary" style="font-size:.7rem">By Revenue</span>
                  </div>
                  <div class="card-body">
                    <table class="table table-sm table-borderless mb-0" id="topSkuTable">
                      <thead>
                        <tr>
                          <th>SKU</th>
                          <th class="text-right">Units Sold</th>
                          <th class="text-right">Revenue</th>
                        </tr>
                      </thead>
                      <tbody></tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
            <!-- END SALES OVERVIEW -->
          </div>
        </div>
      </div>
<div class="tab-pane fade" id="inventoryOverview">
  <!-- KPIs Row (in a single card, with proper centering) -->
  <div class="card mb-3">
    <div class="card-body pb-2">
      <div class="d-flex flex-wrap justify-content-between align-items-stretch" style="gap:1rem;">
        <div class="kpi-card flex-fill text-center">
          <i class="fas fa-boxes"></i>
          <h4 id="invTotalSKUs">0</h4>
          <small>Total SKUs</small>
        </div>
        <div class="kpi-card flex-fill text-center">
          <i class="fas fa-money-bill-wave"></i>
          <h4 id="invTotalValue">₱0</h4>
          <small>Total Stock Value</small>
        </div>
        <div class="kpi-card flex-fill text-center">
          <i class="fas fa-th-large"></i>
          <h4 id="invCategories">0</h4>
          <small>Categories</small>
        </div>
        <div class="kpi-card flex-fill text-center">
          <i class="fas fa-exclamation-triangle text-danger"></i>
          <h4 id="invLowStockCount">0</h4>
          <small>Low Stock (≤10)</small>
        </div>
        <div class="kpi-card flex-fill text-center">
          <i class="fas fa-clock text-warning"></i>
          <h4 id="invExpiringCount">0</h4>
          <small>Expiring Soon</small>
        </div>
      </div>
    </div>
  </div>
  <!-- Analytics Row -->
  <div class="row">
    <!-- Turnover Rate -->
    <div class="col-lg-3 col-md-6 mb-4">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-sync-alt text-primary mb-2" style="font-size:1.6rem"></i>
          <h5 class="mb-1" id="turnoverRate">--</h5>
          <small class="text-muted">Inventory Turnover Rate</small>
          <div class="text-muted" style="font-size: 0.92rem;">(How often stock is sold & replaced)</div>
        </div>
      </div>
    </div>
    <!-- Days of Inventory Left -->
    <div class="col-lg-3 col-md-6 mb-4">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-hourglass-half text-info mb-2" style="font-size:1.6rem"></i>
          <h5 class="mb-1" id="daysLeft">--</h5>
          <small class="text-muted">Days Inventory Left</small>
          <div class="text-muted" style="font-size: 0.92rem;">(Based on sales rate)</div>
        </div>
      </div>
    </div>
    <!-- Most Valuable Category -->
    <div class="col-lg-3 col-md-6 mb-4">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-crown text-warning mb-2" style="font-size:1.6rem"></i>
          <h5 class="mb-1" id="topCategory">--</h5>
          <small class="text-muted">Top Value Category</small>
          <div class="text-muted" style="font-size: 0.92rem;">(Highest total ₱ value)</div>
        </div>
      </div>
    </div>
    <!-- Forecasted Expirations -->
    <div class="col-lg-3 col-md-6 mb-4">
      <div class="card shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-calendar-times text-danger mb-2" style="font-size:1.6rem"></i>
          <h5 class="mb-1" id="nextExpiry">--</h5>
          <small class="text-muted">Next Expiry Date</small>
          <div class="text-muted" style="font-size: 0.92rem;">(Soonest item expiry)</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Chart and Best-Sellers Row -->
  <div class="row">
    <!-- Stock by Category -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card h-100 shadow-sm">
        <div class="card-header d-flex align-items-center py-2 px-3 bg-white">
          <i class="fas fa-layer-group text-primary mr-2"></i>
          <span class="font-weight-bold">Stock by Category</span>
        </div>
        <div class="card-body pt-3">
          <div id="stockByCategoryChart" class="chart"></div>
        </div>
      </div>
    </div>
    <!-- Value by Category -->
    <div class="col-lg-4 col-md-6 mb-4">
      <div class="card h-100 shadow-sm">
        <div class="card-header d-flex align-items-center py-2 px-3 bg-white">
          <i class="fas fa-chart-pie text-warning mr-2"></i>
          <span class="font-weight-bold">Value by Category</span>
        </div>
        <div class="card-body pt-3">
          <div id="valueByCategoryChart" class="chart"></div>
        </div>
      </div>
    </div>
    <!-- Top 5 Best-Sellers -->
    <div class="col-lg-4 col-md-12 mb-4">
      <div class="card h-100 shadow-sm">
        <div class="card-header d-flex align-items-center py-2 px-3 bg-white">
          <i class="fas fa-star text-success mr-2"></i>
          <span class="font-weight-bold">Top 5 Best-Sellers</span>
        </div>
        <div class="card-body p-2">
          <ul class="list-group list-group-flush" id="topSoldList"></ul>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 3) Appointment Trends (MATCH SALES OVERVIEW LAYOUT) -->
<div class="tab-pane fade" id="appointmentTrends">
  <div class="card">
    <div class="card-body">

      <!-- KPI Row -->
      <div class="d-flex flex-wrap mb-4">
        <div class="kpi-card mr-3 mb-3">
          <i class="fas fa-calendar-check"></i>
          <h4 id="kpiAppointments">--</h4>
          <small>Total Appointments</small>
          <div id="kpiAppChange" class="change">--</div>
        </div>
        <div class="kpi-card mr-3 mb-3">
          <i class="fas fa-user-md"></i>
          <h4 id="kpiDoctors">--</h4>
          <small>Doctors Booked</small>
          <div id="kpiDocChange" class="change">--</div>
        </div>
        <div class="kpi-card mr-3 mb-3">
          <i class="fas fa-users"></i>
          <h4 id="kpiClients">--</h4>
          <small>Clients Served</small>
        </div>
        <div class="kpi-card mb-3">
          <i class="fas fa-percentage"></i>
          <h4 id="kpiNoShow">--%</h4>
          <small>No-Show Rate</small>
        </div>
      </div>

      <!-- Charts Row -->
      <div class="row">
        <!-- Appointments Trend -->
        <div class="col-lg-4 col-md-4 mb-4">
          <div class="card h-100 shadow-sm">
            <div class="card-header py-2 px-3 d-flex justify-content-between align-items-center">
              <h6 class="mb-0">Appointments Trend</h6>
              <select id="appointmentTrendRange"
                      class="form-control form-control-sm"
                      style="width:auto;">
                <option value="7d" selected>Last 7 Days</option>
                <option value="30d">Last 30 Days</option>
                <option value="month">Month</option>
                <option value="year">Year</option>
              </select>
            </div>
            <div class="card-body p-2">
  <div class="chart">
    <div id="appointmentsTrendChart"></div>
  </div>
</div>

          </div>
        </div>

        <!-- Peak Day of Week -->
        <div class="col-lg-4 col-md-4 mb-4">
          <div class="card h-100 shadow-sm">
            <div class="card-header py-2 px-3 d-flex justify-content-between align-items-center">
              <h6 class="mb-0">Peak Day-of-Week</h6>
              <select id="peakDayRange"
                      class="form-control form-control-sm"
                      style="width:auto;">
                <option value="7d">Last 7 Days</option>
                <option value="30d" selected>Last 30 Days</option>
                <option value="month">Month</option>
                <option value="year">Year</option>
              </select>
            </div>
            <div class="card-body p-2">
              <div id="peakDayChartWrapper" style="width:100%;height:200px;margin-bottom:12px;">
                <canvas id="peakDayChart"></canvas>
              </div>
              <table class="table table-sm table-borderless mb-0" id="peakDayTable" style="font-size:0.7rem;">
                <thead>
                  <tr><th>Day</th><th class="text-right">Appointments</th></tr>
                </thead>
                <tbody><!-- populated by JS --></tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Forecast (Next 3 Days) -->
     <!-- Forecast (Next 3 Days) -->
<div class="col-lg-4 col-md-4 mb-4">
  <div class="card h-100 shadow-sm">
    <div class="card-header py-2 px-3 d-flex justify-content-between align-items-center">
      <h6 class="mb-0">Appointments Forecast</h6>
      <span class="badge badge-info" style="font-size:.7rem">Next 3 Days</span>
    </div>
    <div class="card-body p-2">
      <!-- ApexCharts sparkline goes here -->
      <div id="predictionChart" style="width:100%;height:120px;margin-bottom:8px;"></div>
      <!-- three-day values -->
      <div id="forecastValues" class="d-flex justify-content-between">
        <!-- JS will inject three blocks here -->
      </div>
    </div>
  </div>
</div>

      <!-- END APPOINTMENT TRENDS -->
    </div>
  </div>
</div>


    </div><!-- /.tab-content -->
  </div><!-- /.container-fluid -->

  <!-- JS includes -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
  ></script>
  <script
    src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
  ></script>
  <script src="https://cdn.jsdelivr.net/npm/moment@2.29.4/moment.min.js"></script>
  <script
    src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"
  ></script>
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- instead of inline JS, load the unified dashboard.js -->
<script src="/js/dashboard.js"></script>




</body>
</html>
